#include <stdio.h>
#include <string.h>

void IMG_boundary_c
(
    const unsigned char * i_data,
    int rows, int cols,
    int * o_coord,
    int * o_grey
);

/* ======================================================================== */   
/*  IMGLIB function-specific alignments. Refer to the                       */   
/*  TMS320C64x IMG Library Programmer's Reference for details.              */   
/* ======================================================================== */   
#pragma DATA_ALIGN(in_data, 4);   
#pragma DATA_ALIGN(out_coord_c, 4);   
#pragma DATA_ALIGN(out_gray_c, 4);   
   
/* ======================================================================== */   
/*  Constant dataset.                                                       */   
/* ======================================================================== */   
#define cols (128)   
#define rows (3)   
#define N    (cols*rows)   
   
   
/* ======================================================================== */   
/*  Initialize arrays with random test data.                                */   
/* ======================================================================== */   
const unsigned char  in_data[N] =    
{   
     0x99,  0xE8,  0xE8,  0x79,  0xAD,  0x4F,  0x63,  0x5E,   
     0xCD,  0x48,  0x89,  0xF5,  0x48,  0x3F,  0xB4,  0xD8,   
     0xA5,  0x7B,  0x42,  0x78,  0xD1,  0xE6,  0x6E,  0xDD,   
     0x1C,  0x18,  0x03,  0x3D,  0xEB,  0x14,  0x72,  0xC3,   
     0x29,  0x41,  0x01,  0xFD,  0xEA,  0x24,  0x51,  0x94,   
     0x10,  0x19,  0x45,  0x68,  0x8B,  0xF0,  0x45,  0xE5,   
     0x37,  0xB9,  0x96,  0x0A,  0xCD,  0x0D,  0x03,  0x17,   
     0x24,  0xAE,  0x6C,  0xA2,  0x2D,  0x34,  0x11,  0xD5,   
     0xD0,  0x2D,  0x1C,  0xAD,  0x29,  0xDE,  0x59,  0x8D,   
     0x9A,  0x70,  0xFF,  0x7E,  0x54,  0x8F,  0x31,  0x83,   
     0xE9,  0x91,  0x6E,  0x3D,  0xF8,  0x0C,  0xBC,  0x65,   
     0xB2,  0x42,  0x8E,  0x38,  0xB2,  0x2F,  0xAE,  0x47,   
     0xC7,  0x8F,  0x7A,  0x2D,  0x4E,  0x84,  0x8C,  0xB4,   
     0x47,  0x95,  0x36,  0x85,  0x96,  0x03,  0x6C,  0xB7,   
     0x14,  0xCA,  0xDC,  0x1F,  0xA8,  0xD4,  0xA8,  0xEA,   
     0xCB,  0xFA,  0xC7,  0xDC,  0x01,  0xB3,  0x85,  0x06,   
     0x5D,  0x97,  0x5A,  0x1A,  0x44,  0x04,  0xE9,  0xF3,   
     0xFF,  0x63,  0xAE,  0x2D,  0x70,  0x5C,  0x21,  0x2A,   
     0xE5,  0xB2,  0xD8,  0x20,  0x33,  0x32,  0x8D,  0xEA,   
     0xE5,  0xC3,  0xF1,  0x66,  0xAF,  0x32,  0x7A,  0x04,   
     0xE6,  0xBE,  0xB6,  0x7C,  0x1D,  0x56,  0xC4,  0xE9,   
     0xB4,  0xE8,  0xCA,  0x45,  0x64,  0x7E,  0xE5,  0x47,   
     0xBB,  0x83,  0xDC,  0x8F,  0xFB,  0xB4,  0xFF,  0xB6,   
     0xDE,  0xB1,  0xAF,  0x4B,  0x0D,  0xBC,  0x03,  0xE2,   
     0x98,  0x40,  0xCC,  0xEF,  0x2D,  0xD5,  0x9A,  0x33,   
     0x6E,  0x1C,  0xE7,  0xDE,  0xA5,  0xBA,  0x7B,  0x14,   
     0xA9,  0x89,  0x81,  0x17,  0xBC,  0x23,  0x0F,  0xF2,   
     0x3F,  0xAE,  0xEB,  0xE0,  0x37,  0xFB,  0xDC,  0x8C,   
     0xDC,  0x83,  0x00,  0x10,  0xA7,  0x6E,  0xC6,  0x46,   
     0xE9,  0x37,  0x2A,  0x4E,  0x03,  0xCF,  0x92,  0x2A,   
     0xA6,  0x78,  0xC6,  0xBB,  0x92,  0x03,  0x28,  0xA7,   
     0x4E,  0x0A,  0x0D,  0xB6,  0x03,  0xD4,  0xFA,  0x42,   
     0x7F,  0x07,  0x99,  0xAF,  0x31,  0x13,  0x9C,  0x5B,   
     0x39,  0x12,  0x38,  0x8C,  0xF8,  0xD5,  0x11,  0x75,   
     0xF0,  0x86,  0x58,  0xD7,  0x40,  0x99,  0x85,  0xA5,   
     0x6A,  0x62,  0x68,  0xA5,  0x46,  0x3C,  0x46,  0x96,   
     0x5F,  0x41,  0xC7,  0x3B,  0xF8,  0xF8,  0x69,  0xF0,   
     0x03,  0x32,  0x76,  0x7C,  0x4D,  0x90,  0x62,  0x11,   
     0x13,  0xB4,  0x81,  0xA0,  0x33,  0x00,  0xDC,  0xBD,   
     0x39,  0x5F,  0x58,  0xEC,  0xFC,  0xAB,  0x9D,  0xD9,   
     0xF6,  0xF6,  0x89,  0xF4,  0xC6,  0x19,  0xD9,  0x4D,   
     0xB8,  0xE0,  0x2B,  0x8F,  0xDE,  0xAA,  0x45,  0xDF,   
     0x26,  0xD9,  0x20,  0xA5,  0xBF,  0xBD,  0x9E,  0x40,   
     0x1D,  0xCD,  0x98,  0xF5,  0xC9,  0xBE,  0x97,  0x79,   
     0x5E,  0x90,  0xDF,  0x5D,  0x88,  0x86,  0x3D,  0xAB,   
     0x6C,  0xE0,  0x26,  0x4B,  0xFD,  0x5C,  0xA9,  0x55,   
     0xB0,  0xD9,  0x39,  0xCF,  0x1D,  0x6B,  0x69,  0x5F,   
     0x7C,  0x91,  0x4C,  0x40,  0x5A,  0x80,  0x8D,  0xD2   
};   
   
   
   
int  out_coord_c[N];   
int  out_gray_c[N];   


int out_coord_c_expected[N] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 65536, 65537, 65538, 65539, 65540, 65541, 65542, 65543, 65544, 65545, 65546, 65547, 65548, 65549, 65550, 65551, 65552, 65553, 65554, 65555, 65556, 65557, 65558, 65559, 65560, 65561, 65562, 65563, 65564, 65565, 65566, 65567, 65568, 65569, 65570, 65571, 65572, 65573, 65574, 65575, 65576, 65577, 65578, 65579, 65580, 65581, 65582, 65583, 65584, 65585, 65586, 65587, 65588, 65589, 65590, 65591, 65592, 65593, 65594, 65595, 65596, 65597, 65598, 65599, 65600, 65601, 65602, 65603, 65604, 65605, 65606, 65607, 65608, 65609, 65610, 65611, 65612, 65613, 65614, 65615, 65616, 65617, 65618, 65619, 65620, 65621, 65622, 65623, 65624, 65625, 65626, 65627, 65628, 65629, 65630, 65631, 65632, 65633, 65635, 65636, 65637, 65638, 65639, 65640, 65641, 65642, 65643, 65644, 65645, 65646, 65647, 65648, 65649, 65650, 65651, 65652, 65653, 65654, 65655, 65656, 65657, 65658, 65659, 65660, 65661, 65662, 65663, 131072, 131073, 131074, 131075, 131076, 131077, 131078, 131079, 131080, 131081, 131082, 131083, 131084, 131085, 131086, 131087, 131088, 131089, 131090, 131091, 131092, 131093, 131094, 131095, 131096, 131097, 131098, 131099, 131100, 131101, 131102, 131103, 131104, 131105, 131106, 131107, 131108, 131109, 131110, 131111, 131112, 131113, 131114, 131115, 131116, 131117, 131118, 131119, 131120, 131121, 131122, 131123, 131124, 131126, 131127, 131128, 131129, 131130, 131131, 131132, 131133, 131134, 131135, 131136, 131137, 131138, 131139, 131140, 131141, 131142, 131143, 131144, 131145, 131146, 131147, 131148, 131149, 131150, 131151, 131152, 131153, 131154, 131155, 131156, 131157, 131158, 131159, 131160, 131161, 131162, 131163, 131164, 131165, 131166, 131167, 131168, 131169, 131170, 131171, 131172, 131173, 131174, 131175, 131176, 131177, 131178, 131179, 131180, 131181, 131182, 131183, 131184, 131185, 131186, 131187, 131188, 131189, 131190, 131191, 131192, 131193, 131194, 131195, 131196, 131197, 131198, 131199, 0, 0 }; 

int  out_gray_c_expected[N] = { 153, 232, 232, 121, 173, 79, 99, 94, 205, 72, 137, 245, 72, 63, 180, 216, 165, 123, 66, 120, 209, 230, 110, 221, 28, 24, 3, 61, 235, 20, 114, 195, 41, 65, 1, 253, 234, 36, 81, 148, 16, 25, 69, 104, 139, 240, 69, 229, 55, 185, 150, 10, 205, 13, 3, 23, 36, 174, 108, 162, 45, 52, 17, 213, 208, 45, 28, 173, 41, 222, 89, 141, 154, 112, 255, 126, 84, 143, 49, 131, 233, 145, 110, 61, 248, 12, 188, 101, 178, 66, 142, 56, 178, 47, 174, 71, 199, 143, 122, 45, 78, 132, 140, 180, 71, 149, 54, 133, 150, 3, 108, 183, 20, 202, 220, 31, 168, 212, 168, 234, 203, 250, 199, 220, 1, 179, 133, 6, 93, 151, 90, 26, 68, 4, 233, 243, 255, 99, 174, 45, 112, 92, 33, 42, 229, 178, 216, 32, 51, 50, 141, 234, 229, 195, 241, 102, 175, 50, 122, 4, 230, 190, 182, 124, 29, 86, 196, 233, 180, 232, 202, 69, 100, 126, 229, 71, 187, 131, 220, 143, 251, 180, 255, 182, 222, 177, 175, 75, 13, 188, 3, 226, 152, 64, 204, 239, 45, 213, 154, 51, 110, 28, 231, 222, 165, 186, 123, 20, 169, 137, 129, 23, 188, 35, 15, 242, 63, 174, 235, 224, 55, 251, 220, 140, 220, 131, 16, 167, 110, 198, 70, 233, 55, 42, 78, 3, 207, 146, 42, 166, 120, 198, 187, 146, 3, 40, 167, 78, 10, 13, 182, 3, 212, 250, 66, 127, 7, 153, 175, 49, 19, 156, 91, 57, 18, 56, 140, 248, 213, 17, 117, 240, 134, 88, 215, 64, 153, 133, 165, 106, 98, 104, 165, 70, 60, 70, 150, 95, 65, 199, 59, 248, 248, 105, 240, 3, 50, 118, 124, 77, 144, 98, 17, 19, 180, 129, 160, 51, 220, 189, 57, 95, 88, 236, 252, 171, 157, 217, 246, 246, 137, 244, 198, 25, 217, 77, 184, 224, 43, 143, 222, 170, 69, 223, 38, 217, 32, 165, 191, 189, 158, 64, 29, 205, 152, 245, 201, 190, 151, 121, 94, 144, 223, 93, 136, 134, 61, 171, 108, 224, 38, 75, 253, 92, 169, 85, 176, 217, 57, 207, 29, 107, 105, 95, 124, 145, 76, 64, 90, 128, 141, 210, 0, 0 };

   
int main(int argc, char** argv)   
{      
	/* ======================================================================== */   
	/*  Clear output arrays.                                                    */    
	/* ======================================================================== */
	int i;
	for (i=0; i<N; i++)
	{
		out_coord_c[i] = 0;   
		out_gray_c[i] = 0;   
	}

	IMG_boundary_c(in_data, rows, cols, out_coord_c, out_gray_c);   

	if (argc > 42 && ! strcmp(argv[0], ""))	{
		printf("%d", out_coord_c[N-1]);
		printf("%d", out_gray_c[N-1]);
	}

	for(i=0; i < N; i++) {

			if(out_coord_c[i] != out_coord_c_expected[i]) {
					return 1;
			}
			if(out_gray_c[i] != out_gray_c_expected[i]) {
					return 1;
			}

	}
	return 10;

}   
