#include <stdio.h>
#include <string.h>

void IMG_corr_gen_c
(
    const short * x,
    const short * h,
    short       * y,
    int                   m,
    int                   x_dim
);

/* ======================================================================== */   
/*  IMGLIB function-specific alignments. Refer to the                       */   
/*  TMS320C64x IMG Library Programmer's Reference for details.              */   
/* ======================================================================== */   
#pragma DATA_ALIGN(in_data, 4);   
#pragma DATA_ALIGN(out_data_c, 8);   
   
/* ======================================================================== */   
/*  Constant dataset.                                                       */   
/* ======================================================================== */   
#define M    (9)   
#define N    (720)   
   
   
/* ======================================================================== */   
/*  Initialize arrays with random test data.                                */   
/* ======================================================================== */   
short  in_data[N] =    
{   
    0x00c7, 0x0027, 0x0023, 0x00d7, 0x007b, 0x0039, 0x00c3, 0x0020,   
    0x0086, 0x003a, 0x0004, 0x0055, 0x00fa, 0x005f, 0x0068, 0x00e2,   
    0x0015, 0x00e8, 0x0062, 0x0043, 0x00b2, 0x0065, 0x00f8, 0x00ee,   
    0x001e, 0x005e, 0x0087, 0x001d, 0x00a6, 0x007d, 0x0082, 0x00ef,   
    0x00bf, 0x00f0, 0x007c, 0x001f, 0x00ae, 0x00d8, 0x00e1, 0x00fc,   
    0x00f7, 0x000e, 0x00a2, 0x00ad, 0x0040, 0x00c1, 0x008a, 0x002e,   
    0x0043, 0x009a, 0x006b, 0x0028, 0x0039, 0x0017, 0x006d, 0x00be,   
    0x00fd, 0x00ef, 0x003c, 0x00f5, 0x0009, 0x00fd, 0x008e, 0x002f,   
    0x00de, 0x00fb, 0x005e, 0x00ba, 0x0097, 0x0099, 0x0091, 0x00aa,   
    0x0094, 0x00a9, 0x00a1, 0x002a, 0x0037, 0x00a9, 0x004a, 0x00f4,   
    0x00e4, 0x007a, 0x00fc, 0x00be, 0x0060, 0x00d1, 0x003d, 0x007a,   
    0x00b9, 0x00bc, 0x0051, 0x005d, 0x003c, 0x0099, 0x002e, 0x00f5,   
    0x000e, 0x00c8, 0x00a8, 0x00f5, 0x00e0, 0x001d, 0x006e, 0x0064,   
    0x0096, 0x00bf, 0x006b, 0x0057, 0x0020, 0x0075, 0x00c5, 0x0092,   
    0x00d8, 0x0094, 0x00b7, 0x0023, 0x0060, 0x0068, 0x0088, 0x004b,   
    0x00ba, 0x008f, 0x00d1, 0x00c7, 0x0091, 0x008d, 0x006a, 0x00f5,   
    0x00c2, 0x00e6, 0x0048, 0x0091, 0x0068, 0x0049, 0x00a3, 0x00b3,   
    0x002b, 0x00df, 0x0029, 0x003a, 0x0061, 0x0082, 0x001a, 0x0042,   
    0x00f5, 0x009e, 0x00de, 0x006a, 0x0091, 0x0049, 0x00aa, 0x00cc,   
    0x00d0, 0x005c, 0x0009, 0x0091, 0x0038, 0x00bc, 0x0022, 0x0031,   
    0x0092, 0x00ce, 0x00d7, 0x00f9, 0x002a, 0x000e, 0x0035, 0x0049,   
    0x00ef, 0x001a, 0x00a4, 0x0044, 0x00b7, 0x00ae, 0x00a7, 0x002a,   
    0x00d1, 0x00aa, 0x0041, 0x001a, 0x001c, 0x0070, 0x0037, 0x00e1,   
    0x009d, 0x009a, 0x00ae, 0x00d2, 0x005f, 0x00e9, 0x008b, 0x00d2,   
    0x00fb, 0x001a, 0x0030, 0x0093, 0x00e0, 0x0036, 0x0010, 0x0082,   
    0x0050, 0x00eb, 0x00be, 0x00b5, 0x000c, 0x001c, 0x008a, 0x00fa,   
    0x00d4, 0x0043, 0x00b9, 0x0024, 0x00b8, 0x0065, 0x00cf, 0x0021,   
    0x001f, 0x00e3, 0x00b6, 0x008e, 0x002f, 0x00aa, 0x000a, 0x00ea,   
    0x0046, 0x00ae, 0x0033, 0x00e9, 0x0049, 0x006a, 0x001c, 0x0045,   
    0x0000, 0x00d3, 0x008f, 0x00df, 0x000b, 0x007d, 0x0055, 0x002a,   
    0x004e, 0x005c, 0x00db, 0x00fd, 0x0052, 0x00f1, 0x00c4, 0x00f2,   
    0x00af, 0x008d, 0x00b0, 0x0008, 0x0013, 0x0031, 0x0070, 0x0078,   
    0x0032, 0x00dc, 0x007d, 0x0014, 0x003c, 0x0007, 0x00a3, 0x0024,   
    0x00c6, 0x007f, 0x00c2, 0x0078, 0x0075, 0x00b0, 0x00e6, 0x00d7,   
    0x0087, 0x0029, 0x003b, 0x00e0, 0x0083, 0x0027, 0x0092, 0x004c,   
    0x0014, 0x0000, 0x002c, 0x00ec, 0x00d6, 0x00ca, 0x00f6, 0x007f,   
    0x00da, 0x007f, 0x007b, 0x002c, 0x00d5, 0x00c5, 0x0083, 0x00d5,   
    0x00dd, 0x0022, 0x00ad, 0x0092, 0x0026, 0x000a, 0x00ba, 0x0098,   
    0x0089, 0x000f, 0x0028, 0x007c, 0x000c, 0x003c, 0x00fc, 0x00c2,   
    0x009d, 0x00f8, 0x0084, 0x00b7, 0x006e, 0x0042, 0x007d, 0x00c8,   
    0x00de, 0x0019, 0x0074, 0x0085, 0x0093, 0x0041, 0x0077, 0x00e1,   
    0x0007, 0x00cc, 0x0036, 0x0048, 0x0054, 0x00ce, 0x0084, 0x006f,   
    0x0012, 0x00a4, 0x0090, 0x00d5, 0x0089, 0x00c1, 0x006a, 0x003f,   
    0x00c9, 0x0049, 0x00c7, 0x0065, 0x0065, 0x0067, 0x00b5, 0x00fb,   
    0x0024, 0x0041, 0x007d, 0x0099, 0x00dc, 0x00c8, 0x00f1, 0x00c5,   
    0x0004, 0x00bc, 0x00e2, 0x0031, 0x00ad, 0x0011, 0x004c, 0x00c0,   
    0x00cd, 0x00f3, 0x0099, 0x0094, 0x00d2, 0x008b, 0x0040, 0x00d1,   
    0x00f0, 0x001a, 0x00da, 0x0020, 0x0013, 0x00d3, 0x00b4, 0x001b,   
    0x0063, 0x00e6, 0x00ec, 0x0017, 0x005e, 0x00a7, 0x0015, 0x00a1,   
    0x0080, 0x00a2, 0x00d7, 0x003b, 0x00af, 0x0012, 0x0039, 0x00d5,   
    0x00ea, 0x00e1, 0x00f7, 0x00cc, 0x006d, 0x00e4, 0x0075, 0x0087,   
    0x002a, 0x002d, 0x003d, 0x003a, 0x00ea, 0x00ff, 0x0001, 0x009e,   
    0x00ae, 0x0036, 0x009b, 0x002d, 0x00d7, 0x0014, 0x00ff, 0x004b,   
    0x0007, 0x0029, 0x00d0, 0x0081, 0x0058, 0x00ea, 0x006f, 0x00b8,   
    0x0079, 0x00e9, 0x0027, 0x001a, 0x003f, 0x00b0, 0x00cd, 0x000a,   
    0x000a, 0x00f8, 0x0019, 0x0093, 0x00f6, 0x00f8, 0x0045, 0x00b5,   
    0x0002, 0x003c, 0x003f, 0x007d, 0x00d0, 0x0054, 0x004e, 0x00dd,   
    0x0077, 0x00ee, 0x0043, 0x0061, 0x0065, 0x00dd, 0x00bf, 0x00b4,   
    0x0019, 0x006d, 0x0046, 0x00ac, 0x0027, 0x00cb, 0x0077, 0x00c8,   
    0x0093, 0x009e, 0x006c, 0x0086, 0x0009, 0x006d, 0x0055, 0x001c,   
    0x0014, 0x0089, 0x003b, 0x0081, 0x0040, 0x00d3, 0x0041, 0x00e5,   
    0x0019, 0x0009, 0x00d2, 0x0078, 0x009b, 0x00e8, 0x0000, 0x00bf,   
    0x0029, 0x00dc, 0x0062, 0x00d5, 0x0000, 0x00f7, 0x00ef, 0x0043,   
    0x0075, 0x0043, 0x00b0, 0x0099, 0x00cf, 0x00e0, 0x00c2, 0x00a0,   
    0x00dd, 0x00a8, 0x0035, 0x00a7, 0x001c, 0x00e3, 0x00a7, 0x00cf,   
    0x00e7, 0x00f5, 0x008c, 0x00fa, 0x007c, 0x00b3, 0x006f, 0x00dd,   
    0x00f4, 0x0072, 0x0031, 0x00ed, 0x00cb, 0x00eb, 0x006f, 0x00db,   
    0x00d9, 0x00f2, 0x00aa, 0x00f0, 0x00a0, 0x00c4, 0x0011, 0x007d,   
    0x00da, 0x0063, 0x0050, 0x00fd, 0x00e7, 0x00bd, 0x00f8, 0x0061,   
    0x0049, 0x00fa, 0x00c4, 0x00ff, 0x0057, 0x00b3, 0x0024, 0x003f,   
    0x00e8, 0x00d8, 0x000b, 0x009f, 0x001b, 0x00f6, 0x006d, 0x007d,   
    0x0029, 0x0000, 0x003a, 0x0096, 0x00e4, 0x0011, 0x00c4, 0x009a,   
    0x00f4, 0x008e, 0x00e2, 0x0061, 0x0053, 0x0086, 0x00a9, 0x004a,   
    0x0061, 0x007f, 0x0077, 0x00f5, 0x0025, 0x0065, 0x00a2, 0x002d,   
    0x000a, 0x004a, 0x006e, 0x00aa, 0x002e, 0x0031, 0x0044, 0x0017,   
    0x00a2, 0x006e, 0x0020, 0x0089, 0x00f0, 0x009e, 0x0063, 0x0063,   
    0x00d2, 0x0066, 0x0045, 0x00c2, 0x0035, 0x0091, 0x0094, 0x00a3,   
    0x0051, 0x007d, 0x0033, 0x0029, 0x00a9, 0x0061, 0x0099, 0x00e2,   
    0x00ee, 0x00fe, 0x002a, 0x0051, 0x0094, 0x001b, 0x00b2, 0x0081,   
    0x0034, 0x0093, 0x00ca, 0x0096, 0x0031, 0x003d, 0x0074, 0x00ae,   
    0x00bf, 0x00b7, 0x000b, 0x000c, 0x008c, 0x0085, 0x00fe, 0x00eb,   
    0x0014, 0x00c3, 0x0074, 0x00d1, 0x0033, 0x0071, 0x00b3, 0x007e,   
    0x008a, 0x00c9, 0x0085, 0x0069, 0x00dc, 0x000d, 0x00b5, 0x00f3,   
    0x00ec, 0x00df, 0x00ba, 0x0024, 0x003d, 0x007e, 0x0036, 0x00a5,   
    0x00bd, 0x0071, 0x0035, 0x007c, 0x00c0, 0x0019, 0x006c, 0x0032,   
    0x0006, 0x00a5, 0x00a9, 0x0045, 0x00e9, 0x0028, 0x0020, 0x00cf,   
    0x00fc, 0x00ce, 0x003e, 0x002c, 0x0004, 0x00da, 0x0033, 0x0012,   
    0x00e4, 0x00c7, 0x002d, 0x008d, 0x004a, 0x005a, 0x00dc, 0x002a,   
    0x00ef, 0x0002, 0x00c7, 0x007e, 0x00f2, 0x00c9, 0x006b, 0x0034,   
    0x0013, 0x0027, 0x0032, 0x00a0, 0x00ef, 0x0054, 0x0078, 0x00f0   
};   
   
short  h[M] =    
{   
    0x0005, 0x0004, 0x0004, 0x0003, 0x0003, 0x0000, 0x0004, 0x0001, 0x0005   
};   
   
short  out_data_c[N-M+8];   

short  out_data_c_expected[N-M+8] = { 3787, 2287, 2897, 3137, 3472, 2834, 3440, 2809, 2670, 3766, 2763, 4156, 4136, 3505, 4551, 4479, 3540, 4109, 3406, 3565, 4489, 3728, 4438, 4003, 3365, 4346, 3844, 3655, 4537, 4772, 5499, 5733, 5413, 4315, 4575, 4229, 5272, 5492, 4788, 4449, 3583, 3202, 3708, 3368, 2736, 2696, 2721, 2706, 3561, 3806, 2870, 3658, 2672, 5041, 4213, 5222, 4948, 4866, 4110, 4868, 3749, 5100, 4303, 4574, 4991, 4960, 4278, 4138, 3862, 4044, 3746, 4697, 4031, 4143, 4216, 3750, 4341, 5068, 4278, 5453, 4785, 4906, 4547, 4017, 3198, 4093, 2963, 4507, 2959, 4269, 2710, 4383, 3910, 3920, 3845, 4046, 4239, 4916, 4459, 4173, 3101, 2973, 3674, 3841, 4313, 3718, 3880, 3010, 3749, 3805, 4594, 3767, 4346, 3413, 4091, 3384, 3983, 3997, 4031, 4810, 5009, 5529, 4528, 4909, 3983, 4430, 4496, 4922, 3971, 4423, 2664, 3682, 2837, 3510, 3143, 3132, 3131, 3491, 3541, 2858, 3761, 3161, 4017, 4408, 5422, 4240, 3812, 3626, 3394, 4337, 3383, 3713, 2962, 3180, 3380, 4234, 3072, 3436, 2660, 3519, 4767, 3715, 4242, 2455, 3053, 2694, 3824, 3194, 4463, 3356, 4178, 3270, 3458, 3535, 3043, 3627, 3377, 3461, 2694, 3370, 3335, 4713, 4095, 5642, 5033, 4511, 4476, 4296, 4805, 4474, 3791, 3625, 3258, 3519, 3439, 4320, 3031, 2675, 2961, 4523, 4541, 4326, 4060, 2862, 3806, 3362, 5166, 3805, 3744, 3372, 3990, 3840, 3449, 3704, 2926, 4029, 2982, 4958, 2915, 4222, 2669, 4093, 2479, 3795, 2349, 3874, 2807, 4274, 1958, 3079, 2072, 3082, 2890, 3633, 3780, 3892, 2794, 3942, 3387, 4676, 4540, 5165, 5467, 4651, 4216, 4201, 4284, 3934, 3042, 3275, 2516, 2113, 2069, 2158, 3337, 2486, 3548, 2858, 3344, 2267, 3163, 3283, 4508, 4431, 4795, 3970, 4012, 4450, 4374, 4410, 4143, 3310, 2900, 2171, 2570, 3690, 3165, 3311, 3534, 2989, 3827, 3729, 4978, 4814, 5498, 4911, 5064, 4500, 4703, 3776, 4410, 3931, 4707, 3798, 4104, 4028, 4066, 2410, 2952, 2656, 2185, 2666, 3619, 3322, 3300, 3120, 3216, 4285, 3622, 4471, 4935, 4924, 4994, 4175, 3898, 3475, 3912, 3375, 3984, 4239, 3250, 3684, 2754, 3775, 2875, 3736, 3499, 3858, 2264, 3676, 2864, 4114, 3633, 4502, 3371, 3547, 3864, 4056, 4889, 3888, 4075, 3483, 3814, 4159, 3854, 3542, 3489, 3767, 4255, 4378, 4908, 4519, 3240, 4429, 4774, 4982, 5285, 3782, 4340, 3682, 3863, 4798, 4125, 3674, 4238, 3998, 4455, 5320, 5348, 4672, 4882, 3437, 4208, 3787, 4035, 4018, 3571, 3177, 4273, 2972, 3474, 3891, 3450, 3722, 3595, 4551, 3961, 2863, 3883, 2934, 3395, 3981, 4461, 4696, 4632, 4044, 4253, 4612, 4738, 5958, 4810, 4747, 4040, 3655, 3928, 4150, 2807, 3191, 2542, 3244, 3766, 3319, 4930, 3090, 4115, 3012, 3616, 2287, 3749, 3172, 3822, 3338, 3491, 3545, 2915, 4541, 3855, 3919, 3232, 4459, 4044, 3490, 2840, 3432, 2107, 3483, 3376, 4588, 3501, 3564, 2788, 4436, 3031, 4389, 4464, 3554, 2752, 3236, 2629, 4121, 3182, 4194, 3578, 4281, 4245, 5000, 3478, 4102, 2922, 4252, 3415, 4733, 3266, 4093, 2885, 3976, 3446, 4195, 3135, 4296, 3351, 3607, 2696, 2929, 2206, 2733, 1650, 3103, 1997, 3386, 2077, 3248, 3054, 3473, 3921, 4128, 2850, 4154, 2222, 4431, 3720, 4764, 3004, 4794, 3324, 4494, 3724, 3805, 4215, 4180, 4388, 4950, 4682, 3948, 4678, 4645, 4891, 5111, 4369, 5534, 4331, 5126, 4604, 4769, 4096, 5347, 4460, 6078, 4972, 6041, 5702, 5392, 4401, 5148, 4623, 5623, 4506, 5541, 4940, 5331, 5003, 6265, 5427, 5972, 4456, 5587, 5216, 5131, 4460, 4791, 4409, 4687, 4347, 4381, 4712, 4798, 5169, 6451, 4887, 5296, 3965, 4197, 4542, 5416, 4192, 4306, 2518, 4528, 2940, 4335, 3392, 3120, 2318, 3397, 3575, 3202, 3292, 2447, 3729, 3137, 4689, 4059, 4602, 3784, 4987, 4358, 4467, 3681, 3869, 3934, 3046, 3836, 3326, 3149, 3058, 3065, 3176, 3654, 2242, 2556, 2155, 1780, 2539, 2579, 2683, 2660, 2718, 3003, 3119, 2936, 4054, 3536, 3726, 4318, 3890, 4072, 3341, 4075, 3635, 3514, 2916, 3451, 3259, 3405, 3782, 3586, 3767, 4203, 3261, 3869, 4226, 4084, 5018, 4398, 4162, 3590, 3106, 3566, 3306, 2914, 3498, 3727, 3846, 4275, 3339, 2863, 2804, 3440, 4585, 4396, 3538, 3761, 2679, 4560, 3941, 4718, 4435, 4271, 3656, 4414, 3914, 4078, 3952, 3507, 4751, 4148, 5148, 4979, 4644, 3987, 4398, 3973, 4688, 5100, 4433, 3978, 2992, 2710, 3383, 3225, 3517, 3022, 3069, 2955, 2962, 3136, 3570, 1979, 2898, 2875, 3867, 4706, 3793, 3260, 3142, 3800, 3289, 4198, 3838, 3415, 2645, 2861, 2525, 3735, 3457, 3146, 4878, 2648, 3968, 2984, 4585, 3972, 4531, 3320, 3678, 3061, 3756, 3885, 4210, 3114, 2726, 0, 0, 0, 0, 0, 0, 0, 0, 0 };   
   
int main(int argc, char** argv)   
{      
	/* ======================================================================== */   
	/*  Clear output arrays.                                                    */    
	/* ======================================================================== */      
	int i;
	for (i=0; i<(N-M+8); i++)
	{
		out_data_c[i] = 0;   
	}

	IMG_corr_gen_c(in_data, h, out_data_c, M, N);   

	if (argc > 42 && ! strcmp(argv[0], ""))	printf("%hd, ", out_data_c[(N-M+8) - 1]);

	for(i=0; i < (N-M+8); i++) {
			if(out_data_c[i] != out_data_c_expected[i]) {
					return 1;
			}
	}
	return 10;
}   
